<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Signing_request (x509.X509.Signing_request)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">x509</a> &#x00BB; <a href="../index.html">X509</a> &#x00BB; Signing_request</nav><h1>Module <code>X509.Signing_request</code></h1><p>A certificate authority (CA) deals with <a href="https://tools.ietf.org/html/rfc2986">PKCS 10 certificate signing requests</a>, their construction and encoding, and provisioning using a private key to generate a certificate with a signature thereof.</p><nav class="toc"><ul><li><a href="#decoding-and-encoding-in-asn.1-der-and-pem-format">Decoding and encoding in ASN.1 DER and PEM format</a></li><li><a href="#construction-of-a-signing-request">Construction of a signing request</a></li><li><a href="#provision-a-signing-request-to-a-certificate">Provision a signing request to a certificate</a></li></ul></nav></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>The abstract type of a (self-signed) certification request.</p></dd></dl><section><header><h2 id="decoding-and-encoding-in-asn.1-der-and-pem-format"><a href="#decoding-and-encoding-in-asn.1-der-and-pem-format" class="anchor"></a>Decoding and encoding in ASN.1 DER and PEM format</h2></header><dl><dt class="spec value" id="val-decode_der"><a href="#val-decode_der" class="anchor"></a><code><span class="keyword">val</span> decode_der : <span>?&#8288;hash_whitelist:<span>Mirage_crypto.Hash.hash list</span></span> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <span>[&gt; Rresult.R.msg ]</span>)</span> Rresult.result</span></code></dt><dd><p><code>decode_der ~hash_whitelist cstruct</code> is <code>signing_request</code>, the ASN.1 decoded <code>cstruct</code> or an error. The signature on the signing request is validated, and its hash algorithm must be in <code>hash_whitelist</code> (by default only SHA-2 is accepted).</p></dd></dl><dl><dt class="spec value" id="val-encode_der"><a href="#val-encode_der" class="anchor"></a><code><span class="keyword">val</span> encode_der : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>encode_der sr</code> is <code>cstruct</code>, the ASN.1 encoded representation of the <code>sr</code>.</p></dd></dl><dl><dt class="spec value" id="val-decode_pem"><a href="#val-decode_pem" class="anchor"></a><code><span class="keyword">val</span> decode_pem : Cstruct.t <span>&#45;&gt;</span> <span><span>(<a href="index.html#type-t">t</a>, <span>[&gt; Rresult.R.msg ]</span>)</span> Rresult.result</span></code></dt><dd><p><code>decode_pem pem</code> is <code>t</code>, where the single signing request of the <code>pem</code> is extracted</p></dd></dl><dl><dt class="spec value" id="val-encode_pem"><a href="#val-encode_pem" class="anchor"></a><code><span class="keyword">val</span> encode_pem : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>encode_pem signing_request</code> is <code>pem</code>, the pem encoded signing request.</p></dd></dl></section><section><header><h2 id="construction-of-a-signing-request"><a href="#construction-of-a-signing-request" class="anchor"></a>Construction of a signing request</h2></header><div class="spec module" id="module-Ext"><a href="#module-Ext" class="anchor"></a><code><span class="keyword">module</span> <a href="Ext/index.html">Ext</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec type" id="type-request_info"><a href="#type-request_info" class="anchor"></a><code><span class="keyword">type</span> request_info</code><code> = </code><code>{</code><table class="record"><tr id="type-request_info.subject" class="anchored"><td class="def field"><a href="#type-request_info.subject" class="anchor"></a><code>subject : <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a>;</code></td></tr><tr id="type-request_info.public_key" class="anchored"><td class="def field"><a href="#type-request_info.public_key" class="anchor"></a><code>public_key : <a href="../Public_key/index.html#type-t">Public_key.t</a>;</code></td></tr><tr id="type-request_info.extensions" class="anchored"><td class="def field"><a href="#type-request_info.extensions" class="anchor"></a><code>extensions : <a href="index.html#module-Ext">Ext</a>.t;</code></td></tr></table><code>}</code></dt><dd><p>The raw request info of a <a href="https://tools.ietf.org/html/rfc2986#section-4">PKCS 10 certification request info</a>.</p></dd></dl><dl><dt class="spec value" id="val-info"><a href="#val-info" class="anchor"></a><code><span class="keyword">val</span> info : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-request_info">request_info</a></code></dt><dd><p><code>info signing_request</code> is <a href="index.html#type-request_info"><code>request_info</code></a>, the information inside the <code>signing_request</code>.</p></dd></dl><dl><dt class="spec value" id="val-signature_algorithm"><a href="#val-signature_algorithm" class="anchor"></a><code><span class="keyword">val</span> signature_algorithm : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(<span>[ `RSA <span>| `ECDSA</span> ]</span> * Mirage_crypto.Hash.hash)</span> option</span></code></dt><dd><p><code>signature_algorithm signing_request</code> is the algorithm used for the signature.</p></dd></dl><dl><dt class="spec value" id="val-hostnames"><a href="#val-hostnames" class="anchor"></a><code><span class="keyword">val</span> hostnames : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Host/index.html#module-Set">Host.Set</a>.t</code></dt><dd><p><code>hostnames signing_request</code> is the set of domain names this <code>signing_request</code> is requesting. This is either the content of the DNS entries of the SubjectAlternativeName extension, or the common name of the <code>signing_request</code>.</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> <span>&#45;&gt;</span> <span>?&#8288;digest:Mirage_crypto.Hash.hash</span> <span>&#45;&gt;</span> <span>?&#8288;extensions:<a href="index.html#module-Ext">Ext</a>.t</span> <span>&#45;&gt;</span> <a href="../Private_key/index.html#type-t">Private_key.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create subject ~digest ~extensions private</code> creates <code>signing_request</code>, a certification request using the given <code>subject</code>, <code>digest</code> (defaults to <code>`SHA256</code>) and list of <code>extensions</code>.</p></dd></dl></section><section><header><h2 id="provision-a-signing-request-to-a-certificate"><a href="#provision-a-signing-request-to-a-certificate" class="anchor"></a>Provision a signing request to a certificate</h2></header><dl><dt class="spec value" id="val-sign"><a href="#val-sign" class="anchor"></a><code><span class="keyword">val</span> sign : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>valid_from:Ptime.t</span> <span>&#45;&gt;</span> <span>valid_until:Ptime.t</span> <span>&#45;&gt;</span> <span>?&#8288;hash_whitelist:<span>Mirage_crypto.Hash.hash list</span></span> <span>&#45;&gt;</span> <span>?&#8288;digest:Mirage_crypto.Hash.hash</span> <span>&#45;&gt;</span> <span>?&#8288;serial:Z.t</span> <span>&#45;&gt;</span> <span>?&#8288;extensions:<a href="../index.html#module-Extension">Extension</a>.t</span> <span>&#45;&gt;</span> <a href="../Private_key/index.html#type-t">Private_key.t</a> <span>&#45;&gt;</span> <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Certificate/index.html#type-t">Certificate.t</a>, <a href="../Validation/index.html#type-signature_error">Validation.signature_error</a>)</span> Rresult.result</span></code></dt><dd><p><code>sign signing_request ~valid_from ~valid_until ~hash_whitelist ~digest ~serial ~extensions private issuer</code> creates <code>certificate</code>, a signed certificate. Signing can fail if the signature on the <code>signing_request</code> is invalid, or its hash algorithm does not occur in <code>hash_whitelist</code> (default all SHA-2 algorithms). Public key and subject are taken from the <code>signing_request</code>, the <code>extensions</code> are added to the X.509 certificate. The <code>private</code> key is used to sign the certificate, the <code>issuer</code> is recorded in the certificate. The digest defaults to <code>`SHA256</code>. The <code>serial</code> defaults to a random value between 1 and 2^64. Certificate version is always 3. Please note that the extensions in the <code>signing_request</code> are ignored, you can pass them using:</p><pre><code class="ml">match Ext.find Extensions (info csr).extensions with
| Ok ext -&gt; ext
| Error _ -&gt; Extension.empty</code></pre></dd></dl></section></div></body></html>