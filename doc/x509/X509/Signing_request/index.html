<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Signing_request (x509.X509.Signing_request)</title><link rel="stylesheet" href="../../../_odoc_support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../_odoc_support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">x509</a> &#x00BB; <a href="../index.html">X509</a> &#x00BB; Signing_request</nav><header class="odoc-preamble"><h1>Module <code><span>X509.Signing_request</span></code></h1><p>A certificate authority (CA) deals with <a href="https://tools.ietf.org/html/rfc2986">PKCS 10 certificate signing requests</a>, their construction and encoding, and provisioning using a private key to generate a certificate with a signature thereof.</p></header><nav class="odoc-toc"><ul><li><a href="#decoding-and-encoding-in-asn.1-der-and-pem-format">Decoding and encoding in ASN.1 DER and PEM format</a></li><li><a href="#construction-of-a-signing-request">Construction of a signing request</a></li><li><a href="#provision-a-signing-request-to-a-certificate">Provision a signing request to a certificate</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>The abstract type of a (self-signed) certification request.</p></div></div><h2 id="decoding-and-encoding-in-asn.1-der-and-pem-format"><a href="#decoding-and-encoding-in-asn.1-der-and-pem-format" class="anchor"></a>Decoding and encoding in ASN.1 DER and PEM format</h2><div class="odoc-spec"><div class="spec value anchored" id="val-decode_der"><a href="#val-decode_der" class="anchor"></a><code><span><span class="keyword">val</span> decode_der : 
  <span>?allowed_hashes:<span><span class="xref-unresolved">Mirage_crypto</span>.Hash.hash list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-t">t</a>, <span>[&gt; <span>`Msg of string</span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>decode_der ~allowed_hashes cstruct</code> is <code>signing_request</code>, the ASN.1 decoded <code>cstruct</code> or an error. The signature on the signing request is validated, and its hash algorithm must be in <code>allowed_hashes</code> (by default only SHA-2 is accepted).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encode_der"><a href="#val-encode_der" class="anchor"></a><code><span><span class="keyword">val</span> encode_der : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p><code>encode_der sr</code> is <code>cstruct</code>, the ASN.1 encoded representation of the <code>sr</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-decode_pem"><a href="#val-decode_pem" class="anchor"></a><code><span><span class="keyword">val</span> decode_pem : <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="#type-t">t</a>, <span>[&gt; <span>`Msg of string</span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>decode_pem pem</code> is <code>t</code>, where the single signing request of the <code>pem</code> is extracted</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encode_pem"><a href="#val-encode_pem" class="anchor"></a><code><span><span class="keyword">val</span> encode_pem : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div><div class="spec-doc"><p><code>encode_pem signing_request</code> is <code>pem</code>, the pem encoded signing request.</p></div></div><h2 id="construction-of-a-signing-request"><a href="#construction-of-a-signing-request" class="anchor"></a>Construction of a signing request</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Ext"><a href="#module-Ext" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Ext/index.html">Ext</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-request_info"><a href="#type-request_info" class="anchor"></a><code><span><span class="keyword">type</span> request_info</span><span> = </span><span>{</span></code><ol><li id="type-request_info.subject" class="def record field anchored"><a href="#type-request_info.subject" class="anchor"></a><code><span>subject : <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a>;</span></code></li><li id="type-request_info.public_key" class="def record field anchored"><a href="#type-request_info.public_key" class="anchor"></a><code><span>public_key : <a href="../Public_key/index.html#type-t">Public_key.t</a>;</span></code></li><li id="type-request_info.extensions" class="def record field anchored"><a href="#type-request_info.extensions" class="anchor"></a><code><span>extensions : <a href="Ext/index.html#type-t">Ext.t</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The raw request info of a <a href="https://tools.ietf.org/html/rfc2986#section-4">PKCS 10 certification request info</a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-info"><a href="#val-info" class="anchor"></a><code><span><span class="keyword">val</span> info : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-request_info">request_info</a></span></code></div><div class="spec-doc"><p><code>info signing_request</code> is <a href="#type-request_info"><code>request_info</code></a>, the information inside the signing_request.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-signature_algorithm"><a href="#val-signature_algorithm" class="anchor"></a><code><span><span class="keyword">val</span> signature_algorithm : 
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Key_type/index.html#type-signature_scheme">Key_type.signature_scheme</a> * <span class="xref-unresolved">Mirage_crypto</span>.Hash.hash)</span> option</span></span></code></div><div class="spec-doc"><p><code>signature_algorithm signing_request</code> is the algorithm used for the signature.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hostnames"><a href="#val-hostnames" class="anchor"></a><code><span><span class="keyword">val</span> hostnames : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Host/Set/index.html#type-t">Host.Set.t</a></span></code></div><div class="spec-doc"><p><code>hostnames signing_request</code> is the set of domain names this <code>signing_request</code> is requesting. This is either the content of the DNS entries of the SubjectAlternativeName extension, or the common name of the <code>signing_request</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span><a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?digest:<span class="xref-unresolved">Mirage_crypto</span>.Hash.hash <span class="arrow">&#45;&gt;</span></span>
  <span>?extensions:<a href="Ext/index.html#type-t">Ext.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Private_key/index.html#type-t">Private_key.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="#type-t">t</a>, <span>[&gt; <span>`Msg of string</span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>create subject ~digest ~extensions private</code> creates <code>signing_request</code>, a certification request using the given <code>subject</code>, <code>digest</code> (defaults to <code>`SHA256</code>) and list of <code>extensions</code>.</p></div></div><h2 id="provision-a-signing-request-to-a-certificate"><a href="#provision-a-signing-request-to-a-certificate" class="anchor"></a>Provision a signing request to a certificate</h2><div class="odoc-spec"><div class="spec value anchored" id="val-sign"><a href="#val-sign" class="anchor"></a><code><span><span class="keyword">val</span> sign : 
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>valid_from:<span class="xref-unresolved">Ptime</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span>valid_until:<span class="xref-unresolved">Ptime</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span>?allowed_hashes:<span><span class="xref-unresolved">Mirage_crypto</span>.Hash.hash list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?digest:<span class="xref-unresolved">Mirage_crypto</span>.Hash.hash <span class="arrow">&#45;&gt;</span></span>
  <span>?serial:<span class="xref-unresolved">Z</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span>?extensions:<a href="../Extension/index.html#type-t">Extension.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?subject:<a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Private_key/index.html#type-t">Private_key.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Certificate/index.html#type-t">Certificate.t</a>, <a href="../Validation/index.html#type-signature_error">Validation.signature_error</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>sign signing_request ~valid_from ~valid_until ~allowed_hashes ~digest ~serial ~extensions ~subject private issuer</code> creates <code>certificate</code>, a signed certificate. Signing can fail if the signature on the <code>signing_request</code> is invalid, or its hash algorithm does not occur in <code>allowed_hashes</code> (default all SHA-2 algorithms). Public key and subject are taken from the <code>signing_request</code> unless <code>subject</code> is passed, the <code>extensions</code> are added to the X.509 certificate. The <code>private</code> key is used to sign the certificate, the <code>issuer</code> is recorded in the certificate. The digest defaults to <code>`SHA256</code>. The <code>serial</code> defaults to a random value between 1 and 2^64. Certificate version is always 3. Please note that the extensions in the <code>signing_request</code> are ignored, you can pass them using:</p><pre class="language-ocaml"><code>match Ext.find Extensions (info csr).extensions with
| Ok ext -&gt; ext
| Error _ -&gt; Extension.empty</code></pre></div></div></div></body></html>