<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Validation (x509.X509.Validation)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">x509</a> &#x00BB; <a href="../index.html">X509</a> &#x00BB; Validation</nav><h1>Module <code>X509.Validation</code></h1><p>Chain Validation.</p><nav class="toc"><ul><li><a href="#certificate-authorities">Certificate Authorities</a></li><li><a href="#chain-of-trust-verification">Chain of trust verification</a></li><li><a href="#fingerprint-verification">Fingerprint verification</a></li></ul></nav></header><aside><p>A chain of pairwise signed X.509 certificates is sent to the endpoint, which use these to authenticate the other endpoint. Usually a set of trust anchors is configured on the endpoint, and the chain needs to be rooted in one of the trust anchors. In reality, chains may be incomplete or reversed, and there can be multiple paths from the leaf certificate to a trust anchor.</p><p>RFC 5280 specifies a <a href="https://tools.ietf.org/html/rfc5280#section-6">path validation</a> algorithm for authenticating chains, but this does not handle multiple possible paths. <a href="https://tools.ietf.org/html/rfc4158">RFC 4158</a> describes possible path building strategies.</p><p>This module provides path building, chain of trust verification, trust anchor (certificate authority) validation, and validation via a fingerprint list (for a trust on first use implementation).</p></aside><dl><dt class="spec type" id="type-signature_error"><a href="#type-signature_error" class="anchor"></a><code><span class="keyword">type</span> signature_error</code> = <code>[ </code><table class="variant"><tr id="type-signature_error.Bad_pkcs1_signature" class="anchored"><td class="def constructor"><a href="#type-signature_error.Bad_pkcs1_signature" class="anchor"></a><code>| </code><code>`Bad_pkcs1_signature <span class="keyword">of</span> <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a></code></td></tr><tr id="type-signature_error.Hash_not_whitelisted" class="anchored"><td class="def constructor"><a href="#type-signature_error.Hash_not_whitelisted" class="anchor"></a><code>| </code><code>`Hash_not_whitelisted <span class="keyword">of</span> <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> * Mirage_crypto.Hash.hash</code></td></tr><tr id="type-signature_error.Unsupported_keytype" class="anchored"><td class="def constructor"><a href="#type-signature_error.Unsupported_keytype" class="anchor"></a><code>| </code><code>`Unsupported_keytype <span class="keyword">of</span> <a href="../Distinguished_name/index.html#type-t">Distinguished_name.t</a> * <a href="../Public_key/index.html#type-t">Public_key.t</a></code></td></tr></table><code> ]</code></dt><dd><p>The type of signature verification errors.</p></dd></dl><dl><dt class="spec value" id="val-pp_signature_error"><a href="#val-pp_signature_error" class="anchor"></a><code><span class="keyword">val</span> pp_signature_error : <span><a href="index.html#type-signature_error">signature_error</a> Fmt.t</span></code></dt><dd><p><code>pp_signature_error ppf sige</code> pretty-prints the signature error <code>sige</code> on <code>ppf</code>.</p></dd></dl><section><header><h2 id="certificate-authorities"><a href="#certificate-authorities" class="anchor"></a>Certificate Authorities</h2></header><dl><dt class="spec type" id="type-ca_error"><a href="#type-ca_error" class="anchor"></a><code><span class="keyword">type</span> ca_error</code> = <code>[ </code><table class="variant"><tr id="type-ca_error.signature_error" class="anchored"><td class="def type"><a href="#type-ca_error.signature_error" class="anchor"></a><code>| </code><code><a href="index.html#type-signature_error">signature_error</a></code></td></tr><tr id="type-ca_error.CAIssuerSubjectMismatch" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAIssuerSubjectMismatch" class="anchor"></a><code>| </code><code>`CAIssuerSubjectMismatch <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-ca_error.CAInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidVersion" class="anchor"></a><code>| </code><code>`CAInvalidVersion <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-ca_error.CACertificateExpired" class="anchored"><td class="def constructor"><a href="#type-ca_error.CACertificateExpired" class="anchor"></a><code>| </code><code>`CACertificateExpired <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-ca_error.CAInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidExtensions" class="anchor"></a><code>| </code><code>`CAInvalidExtensions <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of possible certificate authorities failures.</p></dd></dl><dl><dt class="spec value" id="val-pp_ca_error"><a href="#val-pp_ca_error" class="anchor"></a><code><span class="keyword">val</span> pp_ca_error : <span><a href="index.html#type-ca_error">ca_error</a> Fmt.t</span></code></dt><dd><p><code>pp_ca_error ppf ca_error</code> pretty-prints the CA error <code>ca_error</code>.</p></dd></dl><dl><dt class="spec value" id="val-valid_ca"><a href="#val-valid_ca" class="anchor"></a><code><span class="keyword">val</span> valid_ca : <span>?&#8288;hash_whitelist:<span>Mirage_crypto.Hash.hash list</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> <span>&#45;&gt;</span> <span><span>(unit, <span>[&gt; <a href="index.html#type-ca_error">ca_error</a> ]</span>)</span> Rresult.result</span></code></dt><dd><p><code>valid_ca ~hash_whitelist ~time certificate</code> is <code>result</code>, which is <code>Ok ()</code> if the given certificate is self-signed with any hash algorithm of <code>hash_whitelist</code> (defaults to any hash), it is valid at <code>time</code>, its extensions are not present (if X.509 version 1 certificate), or are appropriate for a CA (BasicConstraints is present and true, KeyUsage extension contains keyCertSign).</p></dd></dl><dl><dt class="spec value" id="val-valid_cas"><a href="#val-valid_cas" class="anchor"></a><code><span class="keyword">val</span> valid_cas : <span>?&#8288;hash_whitelist:<span>Mirage_crypto.Hash.hash list</span></span> <span>&#45;&gt;</span> <span>?&#8288;time:Ptime.t</span> <span>&#45;&gt;</span> <span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span></code></dt><dd><p><code>valid_cas ~hash_whitelist ~time certificates</code> is <code>valid_certificates</code>, only those certificates which pass the <a href="index.html#val-valid_ca"><code>valid_ca</code></a> check.</p></dd></dl></section><section><header><h2 id="chain-of-trust-verification"><a href="#chain-of-trust-verification" class="anchor"></a>Chain of trust verification</h2></header><dl><dt class="spec type" id="type-leaf_validation_error"><a href="#type-leaf_validation_error" class="anchor"></a><code><span class="keyword">type</span> leaf_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-leaf_validation_error.LeafCertificateExpired" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafCertificateExpired" class="anchor"></a><code>| </code><code>`LeafCertificateExpired <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidName" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidName" class="anchor"></a><code>| </code><code>`LeafInvalidName <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * <span><span><span>[ `host ]</span> Domain_name.t</span> option</span></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidVersion" class="anchor"></a><code>| </code><code>`LeafInvalidVersion <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidExtensions" class="anchor"></a><code>| </code><code>`LeafInvalidExtensions <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of a leaf certificate validation error.</p></dd></dl><dl><dt class="spec type" id="type-chain_validation_error"><a href="#type-chain_validation_error" class="anchor"></a><code><span class="keyword">type</span> chain_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-chain_validation_error.IntermediateInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateInvalidExtensions" class="anchor"></a><code>| </code><code>`IntermediateInvalidExtensions <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.IntermediateCertificateExpired" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateCertificateExpired" class="anchor"></a><code>| </code><code>`IntermediateCertificateExpired <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * <span>Ptime.t option</span></code></td></tr><tr id="type-chain_validation_error.IntermediateInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateInvalidVersion" class="anchor"></a><code>| </code><code>`IntermediateInvalidVersion <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainIssuerSubjectMismatch" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainIssuerSubjectMismatch" class="anchor"></a><code>| </code><code>`ChainIssuerSubjectMismatch <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainAuthorityKeyIdSubjectKeyIdMismatch" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainAuthorityKeyIdSubjectKeyIdMismatch" class="anchor"></a><code>| </code><code>`ChainAuthorityKeyIdSubjectKeyIdMismatch <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.ChainInvalidPathlen" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainInvalidPathlen" class="anchor"></a><code>| </code><code>`ChainInvalidPathlen <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * int</code></td></tr><tr id="type-chain_validation_error.EmptyCertificateChain" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.EmptyCertificateChain" class="anchor"></a><code>| </code><code>`EmptyCertificateChain</code></td></tr><tr id="type-chain_validation_error.NoTrustAnchor" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.NoTrustAnchor" class="anchor"></a><code>| </code><code>`NoTrustAnchor <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-chain_validation_error.Revoked" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.Revoked" class="anchor"></a><code>| </code><code>`Revoked <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of a chain validation error.</p></dd></dl><dl><dt class="spec value" id="val-build_paths"><a href="#val-build_paths" class="anchor"></a><code><span class="keyword">val</span> build_paths : <a href="../Certificate/index.html#type-t">Certificate.t</a> <span>&#45;&gt;</span> <span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span> list</span></code></dt><dd><p><code>build_paths server rest</code> is <code>paths</code>, which are all possible certificate paths starting with <code>server</code>. These chains (C1..Cn) fulfill the predicate that each certificate Cn is issued by the next one in the chain (C(n+1)): the issuer of Cn matches the subject of C(n+1). This is as described in <a href="https://tools.ietf.org/html/rfc4158">RFC 4158</a>.</p></dd></dl><dl><dt class="spec type" id="type-chain_error"><a href="#type-chain_error" class="anchor"></a><code><span class="keyword">type</span> chain_error</code> = <code>[ </code><table class="variant"><tr id="type-chain_error.signature_error" class="anchored"><td class="def type"><a href="#type-chain_error.signature_error" class="anchor"></a><code>| </code><code><a href="index.html#type-signature_error">signature_error</a></code></td></tr><tr id="type-chain_error.leaf_validation_error" class="anchored"><td class="def type"><a href="#type-chain_error.leaf_validation_error" class="anchor"></a><code>| </code><code><a href="index.html#type-leaf_validation_error">leaf_validation_error</a></code></td></tr><tr id="type-chain_error.chain_validation_error" class="anchored"><td class="def type"><a href="#type-chain_error.chain_validation_error" class="anchor"></a><code>| </code><code><a href="index.html#type-chain_validation_error">chain_validation_error</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of a chain validation error: either the leaf certificate is problematic, or the chain itself.</p></dd></dl><dl><dt class="spec value" id="val-pp_chain_error"><a href="#val-pp_chain_error" class="anchor"></a><code><span class="keyword">val</span> pp_chain_error : <span><a href="index.html#type-chain_error">chain_error</a> Fmt.t</span></code></dt><dd><p><code>pp_chain_error ppf chain_error</code> pretty-prints the <code>chain_error</code>.</p></dd></dl><dl><dt class="spec value" id="val-verify_chain"><a href="#val-verify_chain" class="anchor"></a><code><span class="keyword">val</span> verify_chain : <span>host:<span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span>&#45;&gt;</span> <span>time:<span>(unit <span>&#45;&gt;</span> <span>Ptime.t option</span>)</span></span> <span>&#45;&gt;</span> <span>?&#8288;revoked:<span>(<span>issuer:<a href="../Certificate/index.html#type-t">Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../Certificate/index.html#type-t">Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span>?&#8288;hash_whitelist:<span>Mirage_crypto.Hash.hash list</span></span> <span>&#45;&gt;</span> <span>anchors:<span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span></span> <span>&#45;&gt;</span> <span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span> <span>&#45;&gt;</span> <span><span>(<a href="../Certificate/index.html#type-t">Certificate.t</a>, <span>[&gt; <a href="index.html#type-chain_error">chain_error</a> ]</span>)</span> Rresult.result</span></code></dt><dd><p><code>verify_chain ~host ~time ~revoked ~hash_whitelist ~anchors chain</code> is <code>result</code>, either <code>Ok</code> and the trust anchor used to verify the chain, or <code>Error</code> and the chain error. RFC 5280 describes the implemented <a href="https://tools.ietf.org/html/rfc5280#section-6.1">path validation</a> algorithm: The validity period of the given certificates is checked against the <code>time</code>. The signature algorithm must be present in <code>hash_whitelist</code> (defaults to SHA-2). The X509v3 extensions of the <code>chain</code> are checked, then a chain of trust from <code>anchors</code> to the server certificate is validated. The path length constraints are checked. The server certificate is checked to contain the given <code>host</code>, using <code>hostnames</code>. The returned certificate is the root of the chain, a member of the given list of <code>anchors</code>.</p></dd></dl><dl><dt class="spec type" id="type-fingerprint_validation_error"><a href="#type-fingerprint_validation_error" class="anchor"></a><code><span class="keyword">type</span> fingerprint_validation_error</code> = <code>[ </code><table class="variant"><tr id="type-fingerprint_validation_error.ServerNameNotPresent" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.ServerNameNotPresent" class="anchor"></a><code>| </code><code>`ServerNameNotPresent <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * <span><span>[ `host ]</span> Domain_name.t</span></code></td></tr><tr id="type-fingerprint_validation_error.NameNotInList" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.NameNotInList" class="anchor"></a><code>| </code><code>`NameNotInList <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a></code></td></tr><tr id="type-fingerprint_validation_error.InvalidFingerprint" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.InvalidFingerprint" class="anchor"></a><code>| </code><code>`InvalidFingerprint <span class="keyword">of</span> <a href="../Certificate/index.html#type-t">Certificate.t</a> * Cstruct.t * Cstruct.t</code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of a fingerprint validation error.</p></dd></dl><dl><dt class="spec type" id="type-validation_error"><a href="#type-validation_error" class="anchor"></a><code><span class="keyword">type</span> validation_error</code> = <code>[ </code><table class="variant"><tr id="type-validation_error.signature_error" class="anchored"><td class="def type"><a href="#type-validation_error.signature_error" class="anchor"></a><code>| </code><code><a href="index.html#type-signature_error">signature_error</a></code></td></tr><tr id="type-validation_error.leaf_validation_error" class="anchored"><td class="def type"><a href="#type-validation_error.leaf_validation_error" class="anchor"></a><code>| </code><code><a href="index.html#type-leaf_validation_error">leaf_validation_error</a></code></td></tr><tr id="type-validation_error.fingerprint_validation_error" class="anchored"><td class="def type"><a href="#type-validation_error.fingerprint_validation_error" class="anchor"></a><code>| </code><code><a href="index.html#type-fingerprint_validation_error">fingerprint_validation_error</a></code></td></tr><tr id="type-validation_error.EmptyCertificateChain" class="anchored"><td class="def constructor"><a href="#type-validation_error.EmptyCertificateChain" class="anchor"></a><code>| </code><code>`EmptyCertificateChain</code></td></tr><tr id="type-validation_error.InvalidChain" class="anchored"><td class="def constructor"><a href="#type-validation_error.InvalidChain" class="anchor"></a><code>| </code><code>`InvalidChain</code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of validation errors.</p></dd></dl><dl><dt class="spec value" id="val-pp_validation_error"><a href="#val-pp_validation_error" class="anchor"></a><code><span class="keyword">val</span> pp_validation_error : <span><a href="index.html#type-validation_error">validation_error</a> Fmt.t</span></code></dt><dd><p><code>pp_validation_error ppf validation_error</code> pretty-prints the <code>validation_error</code>.</p></dd></dl><dl><dt class="spec type" id="type-r"><a href="#type-r" class="anchor"></a><code><span class="keyword">type</span> r</code><code> = <span><span>(<span><span>(<span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span> * <a href="../Certificate/index.html#type-t">Certificate.t</a>)</span> option</span>, <a href="index.html#type-validation_error">validation_error</a>)</span> Rresult.result</span></code></dt></dl><dl><dt class="spec value" id="val-verify_chain_of_trust"><a href="#val-verify_chain_of_trust" class="anchor"></a><code><span class="keyword">val</span> verify_chain_of_trust : <span>host:<span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span>&#45;&gt;</span> <span>time:<span>(unit <span>&#45;&gt;</span> <span>Ptime.t option</span>)</span></span> <span>&#45;&gt;</span> <span>?&#8288;revoked:<span>(<span>issuer:<a href="../Certificate/index.html#type-t">Certificate.t</a></span> <span>&#45;&gt;</span> <span>cert:<a href="../Certificate/index.html#type-t">Certificate.t</a></span> <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span>?&#8288;hash_whitelist:<span>Mirage_crypto.Hash.hash list</span></span> <span>&#45;&gt;</span> <span>anchors:<span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span></span> <span>&#45;&gt;</span> <span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span> <span>&#45;&gt;</span> <a href="index.html#type-r">r</a></code></dt><dd><p><code>verify_chain_of_trust host ~time ~revoked ~hash_whitelist ~anchors certificates</code> is <code>result</code>. First, all possible paths are constructed using the <a href="index.html#val-build_paths"><code>build_paths</code></a> function, the first certificate of the chain is verified to be a valid leaf certificate (no BasicConstraints extension) and contains the given <code>host</code> (using <code>hostnames</code>); if some path is valid, using <a href="index.html#val-verify_chain"><code>verify_chain</code></a>, the result will be <code>Ok</code> and contain the actual certificate chain and the trust anchor.</p></dd></dl></section><section><header><h2 id="fingerprint-verification"><a href="#fingerprint-verification" class="anchor"></a>Fingerprint verification</h2></header><dl><dt class="spec value" id="val-trust_key_fingerprint"><a href="#val-trust_key_fingerprint" class="anchor"></a><code><span class="keyword">val</span> trust_key_fingerprint : <span>host:<span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span>&#45;&gt;</span> <span>time:<span>(unit <span>&#45;&gt;</span> <span>Ptime.t option</span>)</span></span> <span>&#45;&gt;</span> <span>hash:Mirage_crypto.Hash.hash</span> <span>&#45;&gt;</span> <span>fingerprints:<span><span>(<span><span>[ `host ]</span> Domain_name.t</span> * Cstruct.t)</span> list</span></span> <span>&#45;&gt;</span> <span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span> <span>&#45;&gt;</span> <a href="index.html#type-r">r</a></code></dt><dd><p><code>trust_key_fingerprint host ~time ~hash ~fingerprints certificates</code> is <code>result</code>, the first element of <code>certificates</code> is verified against the given <code>fingerprints</code> list using <code>key_fingerprint</code>. If <code>time</code> is provided, the certificate has to be valid at the given timestamp. If <code>host</code> is provided, the certificate is checked for this name. The <code>hostname</code> of the fingerprint list must match the name in the certificate, using <code>hostnames</code>.</p></dd></dl><dl><dt class="spec value" id="val-trust_cert_fingerprint"><a href="#val-trust_cert_fingerprint" class="anchor"></a><code><span class="keyword">val</span> trust_cert_fingerprint : <span>host:<span><span><span>[ `host ]</span> Domain_name.t</span> option</span></span> <span>&#45;&gt;</span> <span>time:<span>(unit <span>&#45;&gt;</span> <span>Ptime.t option</span>)</span></span> <span>&#45;&gt;</span> <span>hash:Mirage_crypto.Hash.hash</span> <span>&#45;&gt;</span> <span>fingerprints:<span><span>(<span><span>[ `host ]</span> Domain_name.t</span> * Cstruct.t)</span> list</span></span> <span>&#45;&gt;</span> <span><a href="../Certificate/index.html#type-t">Certificate.t</a> list</span> <span>&#45;&gt;</span> <a href="index.html#type-r">r</a></code></dt><dd><p><code>trust_cert_fingerprint host ~time ~hash ~fingerprints certificates</code> is <code>result</code>, the first element of <code>certificates</code> is verified to match the given <code>fingerprints</code> list using <code>fingerprint</code>. If <code>time</code> is provided, the certificate is checked to be valid in at the given timestamp. If <code>host</code> is provided, the certificate is checked for this name. The <code>hostname</code> of the fingerprint list must match the name in the certificate, using <code>hostnames</code>. Note that <a href="index.html#val-trust_key_fingerprint"><span>public key pinning</span></a> has <a href="https://www.imperialviolet.org/2011/05/04/pinning.html">advantages</a> over certificate pinning.</p></dd></dl></section></div></body></html>